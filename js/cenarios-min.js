function calculaCenarioInicial(){for(var a=0,o=0,n=0,i=0,e=0,c=0,s=0,t=0,u=0,l=0,d=0,m=0,r=0,p=0,I=0,L=0,T=1;T<=espacoCount;T++)a=fonteLuz[T].tipo==OUTROS?fonteLuz[T].potencia:tipoFonteLuz[fonteLuz[T].tipo].potencia[fonteLuz[T].potencia],o=tipoFonteLuz[fonteLuz[T].tipo].acessorios,i=tipoInstalacao[estadoNum].custo_unit,e=calculaPotenciaInicial(fonteLuz[T].quantidade,a,o),c=calculaConsumoInicial(e,fonteLuz[T].horasFuncionamento),s=calculaCustoEnergiaInicial(c,i),n=fonteLuz[T].rendimento,t=calculaFluxoLuminosoInicial(fonteLuz[T].quantidade,a,n),estado==INTERIOR&&(u=calculaIluminanciaInicial(t,espaco[T].area),l=tipoTipologia[espaco[T].tipologia].iluminanciaRecomendada,d=tipoTipologia[espaco[T].tipologia].dpiMax,m=calclulaDpiInicial(e,espaco[T].area,u)),r+=e,p+=c,I+=s,L+=t,cenarioInicial.push({espacoNum:fonteLuz[T].espacoNum,designacao:fonteLuz[T].designacao,potencia:e,consumo:c,custoEnergia:s,fluxoLuminoso:t,iluminancia:u,iluminanciaAdequada:l,dpi:m,dpiMax:d}),cenarioInicial[TOTAL].potencia=r,cenarioInicial[TOTAL].consumo=p,cenarioInicial[TOTAL].custoEnergia=I,cenarioInicial[TOTAL].fluxoLuminoso=L}function calculaCenarioFinal(){for(var a=0,o=0,n=0,i=0,e=0,c=0,s=0,t=0,u=0,l=0,d=0,m=0,r=0,p=0,I=0,L=0,T=0,F=0,f=0,v=1;v<=espacoCount;v++)u=0,l=0,d=0,i=0,a=calculaPotenciaFinal(cenarioInicial[v].fluxoLuminoso,medidas[medidasDados[v].fonteLuz].poupanca),o=calculaFonteLuzFinal(cenarioInicial[v].consumo,a,fonteLuz[v].horasFuncionamento),medidas.forEach(function(a){a.tipo.match(estado)&&medidasDados[v].reguladoresFluxo==SIM&&(u=a.poupanca)}),n=calculaMedidasSimNaoFinal(a,u,fonteLuz[v].horasFuncionamento),estado==INTERIOR&&medidasDados[v].sensores==SIM&&(medidas.forEach(function(a){a.tipo===SENSORES&&(l=a.poupanca)}),i=calculaMedidasSimNaoFinal(a,l,fonteLuz[v].horasFuncionamento)),medidasDados[v].sistemaGestao==SIM&&(medidas.forEach(function(a){a.tipo===SISTEMAS_GESTAO&&(d=a.poupanca)}),e=calculaMedidasSimNaoFinal(a,d,fonteLuz[v].horasFuncionamento)),c=calculaConsumoFinal(cenarioInicial[v].consumo,o,n,i,e),s=calculaCustoEnergiaFinal(c,tipoInstalacao[estadoNum].custo_unit),t=calculaReducaoAnualFinal(cenarioInicial[v].consumo,c),m+=a,r+=o,p+=n,I+=i,L+=e,T+=c,F+=s,f+=t,cenarioFinal.push({espacoNum:medidasDados[v].espacoNum,designacao:medidasDados[v].designacao,potencia:a,fonteLuz:o,reguladoresFluxo:n,sensores:i,sistemaGestao:e,consumoFinal:c,custoEnergia:s,reducaoAnual:t});cenarioFinal[TOTAL].potencia=m,cenarioFinal[TOTAL].fonteLuz=o,cenarioFinal[TOTAL].reguladoresFluxo=p,cenarioFinal[TOTAL].sensores=I,cenarioFinal[TOTAL].sistemaGestao=L,cenarioFinal[TOTAL].consumoFinal=T,cenarioFinal[TOTAL].custoEnergia=F,cenarioFinal[TOTAL].reducaoAnual=f}function calculaInvestimento(){for(var a=0,o=0,n=0,i=0,e=0,c=0,s=0,t=0,u=0,l=0,d=0,m=0,r=0,p=0,I=0,L=0,T=0,F=1;F<=espacoCount;F++)n=0,i=0,e=0,a=medidas[medidasDados[F].fonteLuz].investimento,fonteLuz[F].quantidade>=descontoInvestimento[0].quantidade?(o=calculaMedidasInvestimento(a,cenarioFinal[F].potencia),o*=1-descontoInvestimento[0].desconto):fonteLuz[F].quantidade>=descontoInvestimento[1].quantidade?(o=calculaMedidasInvestimento(a,cenarioFinal[F].potencia),o*=1-descontoInvestimento[1].desconto):o=calculaMedidasInvestimento(a,cenarioFinal[F].potencia),medidas.forEach(function(a){medidasDados[F].reguladoresFluxo==SIM&&a.tipo.match(estado)?n=calculaMedidasInvestimento(a.investimento,cenarioFinal[F].potencia):medidasDados[F].sensores==SIM&&a.tipo===SENSORES&&estado==INTERIOR?i=calculaMedidasInvestimento(a.investimento,cenarioFinal[F].potencia):medidasDados[F].sistemaGestao==SIM&&a.tipo===SISTEMAS_GESTAO&&(e=calculaMedidasInvestimento(a.investimento,cenarioFinal[F].potencia))}),c=calculaInvestimentoResultadoInvestimento(o,n,i,e),s=calculaReducaoCustos1Investimento(cenarioInicial[F].custoEnergia,cenarioFinal[F].custoEnergia),t=calculaReducaoCustos2Investimento(s,cenarioInicial[F].custoEnergia),u=calculaPriInvestimento(c,s),l+=o,d+=n,m+=i,r+=e,p+=c,I+=s,L+=t,T+=u,investimento.push({espacoNum:medidasDados[F].espacoNum,designacao:medidasDados[F].designacao,fonteLuz:o,reguladoresFluxo:n,sensores:i,sistemaGestao:e,investimento:c,reducaoCustos1:s,reducaoCustos2:t,pri:u});investimento[TOTAL].fonteLuz=l,investimento[TOTAL].reguladoresFluxo=d,investimento[TOTAL].sensores=m,investimento[TOTAL].sistemaGestao=r,investimento[TOTAL].investimento=p,investimento[TOTAL].reducaoCustos1=I,investimento[TOTAL].reducaoCustos2=L,investimento[TOTAL].pri=calculaPriInvestimento(p,I)}